% !TEX root = sms.tex

\section{Basic analytic number theory}
\thanksauthor{Andrew Granville}





We are interested in asymptotics of $\sum_{n\leqslant x} a_n$ for various 
natural arithmetic sequences $\{a_n\}$. There are two main techniques: one is 
geometric, the other uses $L$-functions. 





\subsection{Geometric techniques}

\begin{enonce}[remark]{Example}
Consider the constant sequence $a_n=1$. We have 
$\lfloor x\rfloor = \sum_{1\leqslant n \leqslant x} 1$. More precisely, 
$\sum_{n\leqslant x} 1 = x+O(1)$. 
\end{enonce}

\begin{enonce}[remark]{Example}
We count lattice points inside a disk, i.e.~look at the asymptotics of 
$\#\{(x,y)\in \dZ^2:x^2+y^2\leqslant T\}$. This is approximately the area of 
$\{x^2+y^2\leqslant T\}$. The error comes from the boundary of the region 
$\{x^2+y^2\leqslant T\}$. It will be a bounded multiple of the radious 
$\sqrt T$. So 
\[
  \#\{(x,y)\in \dZ^2:x^2+y^2\leqslant T\} = \pi T + O(T^{1/2}) . 
\]
We might hope for an error term of the form $O(T^{1/2-\epsilon})$ for some 
$\epsilon>0$. 
\end{enonce}

Questions like this become quite subtle if we are looking at intersections 
$\Lambda\cap r\Omega$, where $\Lambda\subset \dR^n$ is a lattice and 
$\Omega\subset \dR^n$ is a bounded region. If $\partial\Omega$ is smooth, 
things work as expected. If, however $\Omega$ has a ``fractal-like'' boundary, 
one has to be very careful. 

\begin{enonce}[remark]{Example}
Let's count the number of lattice points inside an expanding triangle: 
\[
  \#\{(x,y)\in \dZ^2:x,y>0\text{ and }y+\alpha x\leqslant T\} .
\]
The area of the triangle 
$T\Delta = \{x,y>0\text{ and }y+\alpha x\leqslant T\}$ is 
$\frac{1}{2\alpha}T^2$. We get 
\[
  \#(T\Delta\cap \dZ^2) = \frac{1}{2\alpha} T^2 + O(T) .
\]
As with the circle, we could hope for an error term of the form 
$O(T^{1-\epsilon})$ for $\epsilon>0$. By considering $\alpha=-1$, we can see 
that this is not possible. What if $\alpha$ is not rational? If we 
consider 
\[
  \alpha = 1+N^{-1} + 2^{-N} + 2^{2^N} + \cdots
\]
then $\alpha$ is ``almost rational,'' which leads to a ``full error term'' 
$O(T)$ for $\# (T\Delta\cap \dZ^2)$. From this we see that diophantine 
approximation of transcendental numbers is relevant to these sorts of 
problems. 
\end{enonce}

\begin{enonce}[remark]{Example}
Let $d$ be the \emph{divisor function} defined by 
\[
  d(n) = \#\{(a,b)\in \dN:a b=n\} .
\]
We are interested in $\sum_{n\leqslant T} d(n)$. We can rewrite this as 
\begin{align*}
  \sum_{n\leqslant T} d(n) &= \sum_{n\leqslant T} \sum_{\substack{x,y\geqslant 1 \\ x y = n}} 1 = \sum_{\substack{x,y\geqslant 1 \\ x y\leqslant T}} 1 .
\end{align*}
So we're trying to count lattice points in $T\Omega$, where 
\[
  \Omega=\{(x,y)\in \dR^2:x,y>0\text{ and }x y\leqslant 1\} .
\]
But $\Omega$ has infinite area and a pathological boundary. Instead, let's 
count lattice points in 
\[
  \{(x,y)\in \dR^2:x,y>\frac 1 2\text{ and }x y\leqslant T\} .
\]
This is bounded, so we're in good shape. It's area is 
\begin{align*}
  \int_{1/2}^{2 T} \frac{T}{x}\, d x 
    &= T \log(4 T) \\
    &= T\log T+O(T) .
\end{align*}
\end{enonce}

Dirichlet has a beautiful trick for the asymptotics of the divisor function. We 
have 
\begin{align*}
  \sum_{\substack{a,b\geqslant 1 \\ a b\leqslant T}} 1 
    &= \sum_{T\geqslant a\geqslant 1} \sum_{1\leqslant b\leqslant T/a} 1 \\
    &= \sum_{1\leqslant a\leqslant T}\left(\frac T a+O(1)\right) \\
    &= T a\sum_{1\leqslant a\leqslant T} \frac 1 a + O(T) 
\end{align*}
We know that $\sum_{n\leqslant N} \frac 1 n = \log N+\gamma+O(N^{-1})$. This 
also gives us $T\log T+O(T)$. We would like a power-saving error term. 
Dirichlet's insight was that when summing pairs $(a,b)$ with $a b=n$, we can 
restrict to those with $a\leqslant b$. Write $m=\min\{a,b\}$ and 
$n=\max\{a,b\}$. We have 
\begin{align*}
  \sum_{\substack{a b\leqslant T \\ a,b\geqslant 1}} 1
    &= \sum_{1\leqslant m \leqslant \sqrt T} \sum_{m<n \leqslant \frac{T}{m}} 1+\sqrt T ,
\end{align*}
yielding a sum 
\[
  \sum_{n\leqslant T} d(n) = 2 T \sum_{m=1}^{\lfloor \sqrt T\rfloor} \frac 1 m - T+O(\sqrt T) = T\log T+(2\gamma-1)T + O(T^{1/2}) .
\]





\subsection{\texorpdfstring{$L$}{L}-functions}

\begin{enonce}[remark]{Example}
Consider the identity 
\[
  \int_0^1 e^{2\pi i n t}\, dt = \begin{cases} 0 & n=0 \\ 0 & n\ne 0\end{cases} 
\]
This is a characteristic function for the integer $n=0$. Suppose we wanted to 
attack Goldbach's conjecture, which says that each $2 N$ can be written as 
$p+q$ for primes $p+q$. We could look at 
\begin{align*}
  \sum_{p,q\text{ prime}} \begin{cases}1 & p+q-2 N = 0 \\ 0 & \ne 0\end{cases} 
    &= \sum_{p,q} \int_0^1 e^{2i\pi(p+q-2 N) t}\, dt \\
    &= \int_0^1 e^{4 i \pi N t}\left(\sum_p e^{2i \pi t}\right)^2\, dt .
\end{align*}
This is essentially the Hardy-Littlewood circle method. 
\end{enonce}

It would be nice if instead of just characteristic functions of points, we 
could get characteristic functions of more general regions via integrals. One 
has the \emph{Perron formula} 
\[
  \frac{1}{2i\pi} \int_{c-i\infty}^{c+i\infty} e^{s y}\, \frac{ds}{s} = \begin{cases} 1 & y>0 \\ \frac 1 2 & y=0 \\ 0 & y<0 \end{cases} 
\]
for $c>0$. This is essentially Cauchy's residue theorem. One integrates over 
increasingly large squares with $\{\Re z=c\}$ as their right side. 

Suppose $e^y=w$. Then we are integrating $w^s/s$, and the characteristic 
function is for $w>1$. Write 
\begin{align*}
  \sum_{n\leqslant x} a_n 
    &= \sum_{n\geqslant 1} a_n \begin{cases} 1 & x/n>1 \\ 0 & x/n<1 \end{cases} \\
    &= \sum_{n\geqslant 1} a_n \frac{1}{2i\pi} \int_{c-i\infty}^{c+i\infty} \left(\frac x n\right)^s\, \frac{ds}{s} \\
    &= \frac{1}{2i\pi} \int_{c-i\infty}^{c+i\infty} A(s) x^s\, \frac{ds}{s} 
\end{align*}
for $\Re c\gg 0$, where $A(s)=\sum_{n\geqslant 1} \frac{a_n}{n^s}$. 
Let's apply this approach to $\lfloor x\rfloor = \sum_{n\leqslant x} 1$. We get 
\[
  \lfloor x\rfloor = \frac{1}{2i\pi} \int_{2-i\infty}^{2+i\infty} \zeta(s) x^s\, \frac{ds}{s} .
\]
The function $\zeta$ is analytic except at $s=1$, where it has a pole of 
order $1$ with residue $1$. Thus 
\[
  \lfloor x\rfloor = x + \zeta(0) + \text{error} = x-\frac 1 2 + \text{error} .
\]
Our error term is the ``sawtooth function'' $x-\frac 1 2 - \lfloor x\rfloor$. 

Now we consider the more complicated sum $\sum_{n\leqslant x} d(n)$. Our 
corresponding Dirichlet series is 
\[
  D(s) = \sum_{n\geqslant 1} \frac{d(n)}{n^s} = \sum_{n\geqslant 1} n^{-s} \sum_{\substack{a b=n \\ a,b\geqslant 1}} 1 = \sum_{a,b\geqslant 1}\frac{1}{(a b)^s} = \zeta(s)^2 .
\]
Near $s=1$, we have $\zeta(s)=(s-1)^{-1} + \gamma + c(s-1) + \cdots$. So 
\begin{align*}
  \zeta(s)^2 \frac{x^s}{s} 
    &= \left(\frac{1}{s-1} + \gamma+ c_1(s-1)\right)^2 \cdot x \cdot \left(1+(s-1)\log x + \ldots\right)\cdots \\
    &= x\left(\frac{1}{(s-1)^2} + \frac{1}{s-1}(\log x+2\gamma-1) + \cdots\right) .
\end{align*}
This recovers Dirichlet's formula for $\sum_{n\leqslant x} d(n)$. 

Finally, let's review Riemann's original application of the zeta function. 
From the Euler product $\zeta(s) = \prod (1-p^{-s})^{-1}$ valid for 
$\Re s\geqslant 1$, we compute 
\[
  -\frac{\zeta'(s)}{\zeta(s)} = \sum_{\substack{p\text{ prime} \\ m\geqslant 1}} \frac{\log p}{p^{m s}} .
\]
It follows that 
\[
  \sum_{p^m\leqslant x} \log p = \frac{1}{2i\pi} \int_{2-i\infty}^{2+i\infty} -\frac{\zeta'(s)}{\zeta(s)} \frac{x^s}{s}\, ds .
\]
The poles of $\zeta'$ are easy to analyze. The other poles of the integrand 
come from zeros of $\zeta$. We get 
\[
  \sum_{p^m\leqslant x} \log p = x-\frac{\zeta'(0)}{\zeta(0)} - \sum_{\zeta(\rho)=0} \frac{x^\rho}{\rho} .
\]

It is trickier to count lattice points inside a circle using zeta functions. 
We have 
\[
  \sum_{a^2+b^2 \leqslant T} 1 = \sum_{n\leqslant T} R(n) ,
\]
where $R(n)=\#\{(a,b)\in \dZ^2:n=a^2+b^2\}=4 r(n)$. The Dirichlet series has 
an Euler product 
\[
  \left(1-\frac{1}{2^s}\right)^{-1} \prod_{p\equiv 1\pmod 4} \left(1-\frac{1}{p^s}\right)^{-2} \prod_{p\equiv 3\pmod 4} \left(1-\frac{1}{p^{2 s}}\right)^{-1} 
\]
If $\chi=\bigl(\frac{-4}{\cdot}\bigr)$, then 
\[
  L(s,\chi) = \prod_{p\equiv 1\pmod 4} \left(1-\frac{1}{p^s}\right)^{-1} \prod_{p\equiv 3\pmod 4} \left(1+\frac{1}{p^s}\right)^{-1} .
\]
It follows that our Dirichlet series is $\zeta(s) L(s,\chi)$. 





\subsection{Sieving}

Let's try to count square-free integers. We have 
\begin{align*}
  \sum_{\substack{n\leqslant x \\ n\text{ squarefree}}} 1 
    &= \lfloor x\rfloor - \sum_p \#\{n\leqslant x:p^2\mid n\} + \sum_{p,q} \#\{n\leqslant x:p^2 q^2\mid n\} \\
    &= \lfloor x\rfloor - \sum_p \left\lfloor\frac{x}{p^2}\right\rfloor + \sum_{p,q} \left\lfloor\frac{x}{p^2 q^2}\right\rfloor \\
    &= x+O(1) - \sum_{p\leqslant x} \left(\frac{x}{p^2} + O(1)\right) + \sum_{p,q} \left(\frac{x}{p^2 q^2}+O(1)\right) \\
    &= x\prod_p \left(1-\frac{1}{p^2}\right) + \text{error} \\
    &= \frac{6}{\pi^2} x + \text{error}
\end{align*}
A less risky approach (one that does not have as many error terms) is to write 
\begin{align*}
  \sum_{\substack{n\leqslant x \\ n\text{ squarefree}}} 1
    &= \sum_{\substack{n\leqslant x \\ p^2\mid n\text{ for all }p\leqslant y}} 1 + \text{error} ,
\end{align*}
where $y=\log x$ and 
\[
  |\text{error}| \leqslant \sum_{y<p<\sqrt x} \# \{n\leqslant x:p^2\mid n\} .
\]

A similar problem is 
\begin{align*}
  \#\{n\leqslant x:n^2+1\text{ is squarefree}\} = \sum_{\substack{n\leqslant x \\ p^2\nmid n^2+1\text{ for }p\leqslant y}} 1 + O\left(\sum_{y<p<x} \# \{n\leqslant x:p^2\mid n^2+1\}\right) .
\end{align*}
The summand inside the big-$O$ is bounded above by 
$2\left(\frac{x}{p^2} + 1\right)$. 

\begin{enonce}{Conjecture}
For all $\varepsilon>0$, there is a constant $\kappa_\varepsilon$ such that 
whenever $a+b=c$ with $(a,b)=1$, then 
\[
  \prod_{p\mid a b c} p > \kappa_\varepsilon \max\{|a|,|b|\}^{1-\varepsilon} = \kappa H(a,b)^{1-\varepsilon} .
\]
\end{enonce}
A remarkable article of Noam Elkies relates the $abc$-conjecture to 
Belyi maps. The $abc$ conjecture implies that if $F(x,y)\in \dZ[x,y]$ is a 
homogeneous polynomial, then 
\[
  \prod_{p\mid F(a,b)} p > \kappa H(a,b)^{\deg F-2-\varepsilon}
\]
Given $f$, set $F(x,y) = y^{d+1} f(x/y)$. Then a consequence of $abc$ is 
\[
  \prod_{p\mid f(n)} p > \kappa_\varepsilon |n|^{\deg f+1-\varepsilon} .
\]

See \cite{e91} for details. 

We could also consider $4 a^3+ 27 b^2$ divisible by $p^2$. 




